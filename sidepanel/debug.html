<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Convert.com Experiment Builder</title>
    <style>
        body { 
            font-family: system-ui; 
            padding: 20px; 
            background: #f5f5f5; 
        }
        .debug-section { 
            background: white; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .status { 
            padding: 5px 10px; 
            border-radius: 4px; 
            margin: 5px 0; 
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .loading { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>🔧 Extension Debug Mode</h1>
    
    <div class="debug-section">
        <h3>Page Load Status</h3>
        <div id="pageStatus" class="status loading">Loading...</div>
        <div id="domStatus" class="status loading">DOM Loading...</div>
        <div id="scriptsStatus" class="status loading">Scripts Loading...</div>
    </div>

    <div class="debug-section">
        <h3>Console Messages</h3>
        <div id="console" style="font-family: monospace; background: #f8f9fa; padding: 10px; border-radius: 4px; white-space: pre-line;">
            <!-- Console messages will appear here -->
        </div>
    </div>

    <div class="debug-section">
        <h3>Quick Actions</h3>
        <button onclick="window.location.reload()" style="padding: 8px 16px; margin: 5px;">Reload Page</button>
        <button onclick="testBasicFunctionality()" style="padding: 8px 16px; margin: 5px;">Test Basic Functions</button>
        <button onclick="loadNormalInterface()" style="padding: 8px 16px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px;">Load Normal Interface</button>
    </div>

    <script>
        const console = document.getElementById('console');
        const originalLog = window.console.log;
        const originalError = window.console.error;
        
        // Capture console messages
        function addMessage(type, ...args) {
            const message = args.join(' ');
            console.textContent += `[${type}] ${new Date().toTimeString().split(' ')[0]} ${message}\n`;
            console.scrollTop = console.scrollHeight;
        }
        
        window.console.log = (...args) => {
            originalLog.apply(window.console, args);
            addMessage('LOG', ...args);
        };
        
        window.console.error = (...args) => {
            originalError.apply(window.console, args);
            addMessage('ERROR', ...args);
        };
        
        // Update status
        function updateStatus(id, text, type) {
            const el = document.getElementById(id);
            if (el) {
                el.textContent = text;
                el.className = `status ${type}`;
            }
        }
        
        // Test basic functionality
        function testBasicFunctionality() {
            console.log('🧪 Running basic tests...');
            
            // Test Chrome APIs
            if (typeof chrome !== 'undefined') {
                console.log('✅ Chrome APIs available');
                if (chrome.tabs) console.log('✅ Chrome tabs API available');
                if (chrome.runtime) console.log('✅ Chrome runtime API available');
            } else {
                console.error('❌ Chrome APIs not available');
            }
            
            // Test if we can access the main app element
            const app = document.querySelector('.app-v2');
            if (app) {
                console.log('✅ Main app element found');
            } else {
                console.error('❌ Main app element not found');
            }
            
            console.log('🧪 Basic tests complete');
        }
        
        // Load normal interface
        function loadNormalInterface() {
            console.log('🔄 Loading normal interface...');
            window.location.href = 'sidepanel.html';
        }
        
        // Initialize debug page
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus('pageStatus', 'Page Loaded', 'success');
            updateStatus('domStatus', 'DOM Ready', 'success');
            
            console.log('🎯 Debug mode initialized');
            console.log('📍 Current URL:', window.location.href);
            console.log('🔧 User Agent:', navigator.userAgent);
            
            testBasicFunctionality();
        });
        
        window.addEventListener('load', () => {
            updateStatus('scriptsStatus', 'All Scripts Loaded', 'success');
        });
    </script>
</body>
</html>